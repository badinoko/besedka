# üéØ –ß–µ—Ä—Ç–µ–∂ —á–∞—Ç–∞ "–ë–µ—Å–µ–¥–∫–∞" (Telegram-like)

**–í–µ—Ä—Å–∏—è:** 1.0
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 13 –∏—é–ª—è 2025
**–°—Ç–∞—Ç—É—Å:** –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

## 1. –í–≤–µ–¥–µ–Ω–∏–µ

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç ‚Äî –≥–ª–∞–≤–Ω—ã–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤—ã–π —á–µ—Ä—Ç–µ–∂ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —á–∞—Ç–∞ –ø—Ä–æ–µ–∫—Ç–∞ "–ë–µ—Å–µ–¥–∫–∞", –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ —Ä–µ–≤–µ—Ä—Å-–∏–Ω–∂–∏–Ω–∏—Ä–∏–Ω–≥–µ –∏ –∞–Ω–∞–ª–∏–∑–µ –ª—É—á—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ Telegram (Web, Desktop).

**–¶–µ–ª—å:** –ü—Ä–µ–∫—Ä–∞—Ç–∏—Ç—å "–∏–∑–æ–±—Ä–µ—Ç–µ–Ω–∏–µ –≤–µ–ª–æ—Å–∏–ø–µ–¥–∞" –∏ –Ω–∞—á–∞—Ç—å —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π. –≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —è–≤–ª—è–µ—Ç—Å—è **–ï–¥–∏–Ω—ã–º –ò—Å—Ç–æ—á–Ω–∏–∫–æ–º –ü—Ä–∞–≤–¥—ã (SSOT)** –¥–ª—è –≤—Å–µ–≥–æ, —á—Ç–æ –∫–∞—Å–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ —á–∞—Ç–∞.

–û–Ω –∑–∞–º–µ–Ω—è–µ—Ç —Å–æ–±–æ–π —Ä–∞–∑—Ä–æ–∑–Ω–µ–Ω–Ω—ã–µ –ø–ª–∞–Ω—ã –∏–∑ `CUSTOM_CHAT_DEVELOPMENT_ROADMAP.md` –∏ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –∏—Ö –≤ –µ–¥–∏–Ω—É—é, —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É.

## 2. –§—É–Ω–¥–∞–º–µ–Ω—Ç: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏—è

–í—Å–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–æ–æ–±—â–µ–Ω–∏—è. –≠—Ç–æ –æ—Å–Ω–æ–≤–∞ –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞, –æ—Ç–≤–µ—Ç–æ–≤, –ø–µ—Ä–µ—Å—ã–ª–∫–∏, —Ä–µ–∞–∫—Ü–∏–π –∏ –º–Ω–æ–≥–æ–≥–æ –¥—Ä—É–≥–æ–≥–æ.

### 2.1. –í–∏–∑—É–∞–ª—å–Ω–∞—è –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è (–∞–Ω–∞–ª–∏–∑ Telegram)

–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö –∏ –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –±–ª–æ–∫–æ–≤:

```
+------------------------------------------------------+
| [AVATAR] (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –≤ –≥—Ä—É–ø–ø–∞—Ö)                    |
| +--------------------------------------------------+ |
| | [–ò–ú–Ø –ê–í–¢–û–†–ê] (–¶–≤–µ—Ç–Ω–æ–µ, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏)    | |
| +--------------------------------------------------+ |
| | [–¶–ò–ê–¢–ê / –ü–ï–†–ï–°–´–õ–ö–ê] (–ï—Å–ª–∏ –µ—Å—Ç—å)                  | |
| |   +--------------------------------------------+ | |
| |   | –ò–º—è –∞–≤—Ç–æ—Ä–∞ —Ü–∏—Ç–∞—Ç—ã                          | | |
| |   | –¢–µ–∫—Å—Ç —Ü–∏—Ç–∞—Ç—ã (–ø—Ä–µ–≤—å—é)                      | | |
| |   +--------------------------------------------+ | |
| +--------------------------------------------------+ |
| | [–ö–û–ù–¢–ï–ù–¢]                                        | |
| |   - –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (—Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º)          | |
| |   - –ú–µ–¥–∏–∞ (–∫–∞—Ä—Ç–∏–Ω–∫–∞, –≤–∏–¥–µ–æ, —Ñ–∞–π–ª)                | |
| +--------------------------------------------------+ |
| | [–ú–ï–¢–ê–î–ê–ù–ù–´–ï]                                     | |
| |   - –í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏ (–ß–ß:–ú–ú)                       | |
| |   - –°—Ç–∞—Ç—É—Å (‚úì - –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ, ‚úì‚úì - –ø—Ä–æ—á–∏—Ç–∞–Ω–æ)      | |
| +--------------------------------------------------+ |
| +--------------------------------------------------+ |
| | [–†–ï–ê–ö–¶–ò–ò] (–ï—Å–ª–∏ –µ—Å—Ç—å)                            | |
| |   [üëç 2] [üéâ 1] [ü§î 5]                            | |
| +--------------------------------------------------+ |
+------------------------------------------------------+
```

### 2.2. –ù–∞—à–∞ –º–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö (`chat/models.py`) vs. Telegram

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ:**

| –≠–ª–µ–º–µ–Ω—Ç Telegram | –ù–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ `Message` –º–æ–¥–µ–ª–∏ | –°—Ç–∞—Ç—É—Å –∏ –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π |
| :--- | :--- | :--- |
| **–ê–≤–∞—Ç–∞—Ä** | –ö–æ—Å–≤–µ–Ω–Ω–æ —á–µ—Ä–µ–∑ `author.avatar` | ‚úÖ **–ì–û–¢–û–í–û**. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ UI. |
| **–ò–º—è –∞–≤—Ç–æ—Ä–∞** | `author.display_name` | ‚úÖ **–ì–û–¢–û–í–û**. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ UI, –≤–∫–ª—é—á–∞—è –∑–Ω–∞—á–∫–∏ —Ä–æ–ª–µ–π. |
| **–¶–∏—Ç–∞—Ç–∞ (Reply)** | `parent = models.ForeignKey(...)` | ‚úÖ **–ì–û–¢–û–í–û**. –ö–ª—é—á–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞. |
| **–ü–µ—Ä–µ—Å—ã–ª–∫–∞ (Forward)** | `forwarded_from = models.ForeignKey(...)` | üü® **–ß–ê–°–¢–ò–ß–ù–û**. –ú–æ–¥–µ–ª—å –µ—Å—Ç—å, –Ω–æ UI –∏ –ª–æ–≥–∏–∫–∞ –Ω–µ –¥–æ –∫–æ–Ω—Ü–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã. **–ó–ê–î–ê–ß–ê: ¬ß3.2** |
| **–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è** | `content = models.TextField()` | ‚úÖ **–ì–û–¢–û–í–û**. –û—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç. |
| **–ú–µ–¥–∏–∞** | `image = models.ImageField(...)` | üü® **–ß–ê–°–¢–ò–ß–ù–û**. –¢–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. –ù–µ—Ç –≤–∏–¥–µ–æ, —Ñ–∞–π–ª–æ–≤. **–ó–ê–î–ê–ß–ê: ¬ß4.1** |
| **–í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏** | `created_at = models.DateTimeField(...)` | ‚úÖ **–ì–û–¢–û–í–û**. |
| **"–£–º–Ω—ã–µ" –º–µ—Ç–∫–∏** | `(–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è)` | ‚ùå **–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û**. **–ó–ê–î–ê–ß–ê: ¬ß2.4** |
| **–°—Ç–∞—Ç—É—Å —Å–æ–æ–±—â–µ–Ω–∏—è**| `is_read = models.BooleanField(...)` | üü® **–ß–ê–°–¢–ò–ß–ù–û**. –ï—Å—Ç—å –ø—Ä–æ—Å—Ç–æ–π —Ñ–ª–∞–≥, –Ω–æ –Ω–µ—Ç –¥–≤–æ–π–Ω—ã—Ö –≥–∞–ª–æ—á–µ–∫ (‚úì‚úì). **–ó–ê–î–ê–ß–ê: ¬ß5.1** |
| **–†–µ–∞–∫—Ü–∏–∏** | `Reaction` –º–æ–¥–µ–ª—å (`content_type`, `object_id`) | ‚úÖ **–ì–û–¢–û–í–û**. –ë–∞–∑–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç. |
| **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** | `updated_at` | ‚úÖ **–ì–û–¢–û–í–û**. –ï—Å—Ç—å —Ñ–ª–∞–≥ –∏ –ª–æ–≥–∏–∫–∞. |

### 2.3. –ü–ª–∞–Ω –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –ú–æ–¥–µ–ª–∏ –∏ API

1.  **`Message` –º–æ–¥–µ–ª—å (`chat/models.py`):**
    *   –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `forwarded_from_chat_name` (CharField) –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–º–µ–Ω–∏ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ —á–∞—Ç–∞ –ø—Ä–∏ –ø–µ—Ä–µ—Å—ã–ª–∫–µ.
    *   –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `file = models.FileField(...)` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ª—é–±—ã—Ö —Ñ–∞–π–ª–æ–≤.
    *   –ü–æ–¥—É–º–∞—Ç—å –Ω–∞–¥ –µ–¥–∏–Ω—ã–º –ø–æ–ª–µ–º –¥–ª—è –º–µ–¥–∏–∞ –≤–º–µ—Å—Ç–æ `image` –∏ `file`. –í–æ–∑–º–æ–∂–Ω–æ, —á–µ—Ä–µ–∑ `GenericForeignKey`. (–ö –æ–±—Å—É–∂–¥–µ–Ω–∏—é).

2.  **`message_to_json` —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä (`chat/consumers.py`):**
    *   –î–æ–±–∞–≤–∏—Ç—å –≤ –≤—ã–≤–æ–¥ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ–ª—è –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞: `forward_info`, `reactions_summary`, `status`.
    *   –°–æ–∑–¥–∞—Ç—å `get_relative_time` —É—Ç–∏–ª–∏—Ç—É –∏ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `relative_time`.

### 2.4. –ó–ê–î–ê–ß–ê: "–£–º–Ω—ã–µ" –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ (Smart Timestamps)

**–¶–µ–ª—å:** –ó–∞–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç–∏—á–Ω–æ–µ –≤—Ä–µ–º—è "–ß–ß:–ú–ú" –Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ, –∫–∞–∫ –≤ Telegram.

**–õ–æ–≥–∏–∫–∞ (Frontend, JavaScript):**

*   **–°–µ–≥–æ–¥–Ω—è:** `15:30`
*   **–í—á–µ—Ä–∞:** `–í—á–µ—Ä–∞, 15:30`
*   **–í —Ç–µ—á–µ–Ω–∏–µ –Ω–µ–¥–µ–ª–∏:** `–ü–Ω, 15:30`
*   **–î–∞–≤–Ω–æ:** `10.07.2025`

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
1.  **Backend:** –û—Ç–¥–∞–≤–∞—Ç—å `created_at` –∫–∞–∫ ISO timestamp –≤ JSON.
2.  **Frontend:** –°–æ–∑–¥–∞—Ç—å JS-—Ñ—É–Ω–∫—Ü–∏—é `formatTimestamp(iso_string)`, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å –≤—ã—à–µ–æ–ø–∏—Å–∞–Ω–Ω—É—é –ª–æ–≥–∏–∫—É.
3.  **UI:** –ü—Ä–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤—ã–∑—ã–≤–∞—Ç—å —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é. –ü—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—É—é –¥–∞—Ç—É –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –≤–æ –≤—Å–ø–ª—ã–≤–∞—é—â–µ–π –ø–æ–¥—Å–∫–∞–∑–∫–µ (tooltip).

---
## 3. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Å–æ–æ–±—â–µ–Ω–∏–π

### 3.1. –°–∏—Å—Ç–µ–º–∞ –æ—Ç–≤–µ—Ç–æ–≤ (Replies)

**–≠—Ç–∞–ª–æ–Ω–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (Telegram):**
- **UI –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏:** –í–Ω—É—Ç—Ä–∏ —Å–æ–æ–±—â–µ–Ω–∏—è-–æ—Ç–≤–µ—Ç–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–µ–±–æ–ª—å—à–æ–π –±–ª–æ–∫ —Å –∏–º–µ–Ω–µ–º –∞–≤—Ç–æ—Ä–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –ø—Ä–µ–≤—å—é —Ç–µ–∫—Å—Ç–∞.
- **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:** –ö–ª–∏–∫ –ø–æ —ç—Ç–æ–º—É –±–ª–æ–∫—É –ø–ª–∞–≤–Ω–æ —Å–∫—Ä–æ–ª–ª–∏—Ç —á–∞—Ç –∫ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é –∏ –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ—Ç –µ–≥–æ.
- **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–∞–¥ –ø–æ–ª–µ–º –≤–≤–æ–¥–∞:** –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–æ—Ç–≤–µ—Ç–∏—Ç—å", –Ω–∞–¥ –ø–æ–ª–µ–º –≤–≤–æ–¥–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø–ª–∞—à–∫–∞ "–û—Ç–≤–µ—Ç –Ω–∞ [–∏–º—è –∞–≤—Ç–æ—Ä–∞]", –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å.

**–ù–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (–ê—É–¥–∏—Ç):**
- ‚úÖ **Backend:** –ú–æ–¥–µ–ª—å `Message` –∏–º–µ–µ—Ç `parent = models.ForeignKey('self', ...)` –¥–ª—è —Å–≤—è–∑–∏.
- ‚úÖ **UI –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏:** –ú—ã –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º –±–ª–æ–∫ —Å —Ü–∏—Ç–∞—Ç–æ–π.
- üü® **–°–∫—Ä–æ–ª–ª –∫ –æ—Ä–∏–≥–∏–Ω–∞–ª—É:** –§—É–Ω–∫—Ü–∏—è —Å–∫—Ä–æ–ª–ª–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞, –Ω–æ –∏–Ω–æ–≥–¥–∞ –¥–∞–≤–∞–ª–∞ —Å–±–æ–∏, –µ—Å–ª–∏ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –±—ã–ª–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –≤ DOM. **–ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞** –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –ø–æ–¥–≥—Ä—É–∑–∫–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –∫–∞–∫ —É–∫–∞–∑–∞–Ω–æ –≤ `PROGRESS.md`.
- ‚úÖ **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–∞–¥ –ø–æ–ª–µ–º –≤–≤–æ–¥–∞:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω.

**–ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π:**
- **–ó–ê–î–ê–ß–ê:** –ü—Ä–æ–≤–µ—Å—Ç–∏ —Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã –æ—Ç–≤–µ—Ç–æ–≤. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å–∫—Ä–æ–ª–ª –∫ –æ—Ä–∏–≥–∏–Ω–∞–ª—É —Å—Ç–∞–±–∏–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –æ—á–µ–Ω—å —Å—Ç–∞—Ä—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (—Ç—Ä–µ–±—É—é—â–∏—Ö –ø–æ–¥–≥—Ä—É–∑–∫–∏ —Å –±—ç–∫–µ–Ω–¥–∞). –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ—Å–ª–µ —Å–∫—Ä–æ–ª–ª–∞ –∫ —Ü–∏—Ç–∞—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤—Å–µ –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã (—Å—á–µ—Ç—á–∏–∫–∏ –∏ —Ç.–¥.).

### 3.2. –°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ—Å—ã–ª–∫–∏ (Forwarding)

**–≠—Ç–∞–ª–æ–Ω–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (Telegram):**
- **UI –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏:** –ü–æ—Ö–æ–∂–µ –Ω–∞ –æ—Ç–≤–µ—Ç, –Ω–æ —Å –º–µ—Ç–∫–æ–π "–ü–µ—Ä–µ—Å–ª–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ" –∏ —É–∫–∞–∑–∞–Ω–∏–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∞–≤—Ç–æ—Ä–∞/–∫–∞–Ω–∞–ª–∞.
- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–≤—è–∑–∏:** –ü–µ—Ä–µ—Å–ª–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ ‚Äî —ç—Ç–æ *–∫–æ–ø–∏—è*. –û–Ω–æ –Ω–µ —Å–≤—è–∑–∞–Ω–æ —Å –æ—Ä–∏–≥–∏–Ω–∞–ª–æ–º –∏ –Ω–µ –≤–µ–¥–µ—Ç –∫ –Ω–µ–º—É –ø—Ä–∏ –∫–ª–∏–∫–µ.
- **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ø–µ—Ä–µ—Å—ã–ª–∫–∞:** –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –ø–µ—Ä–µ—Å–ª–∞—Ç—å –∏—Ö –∫–∞–∫ –æ–¥–Ω–æ.

**–ù–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (–ê—É–¥–∏—Ç):**
- üü® **Backend:** –ú–æ–¥–µ–ª—å `Message` –∏–º–µ–µ—Ç –ø–æ–ª–µ `forwarded_from`, –Ω–æ –æ–Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø–æ–ª–Ω–æ–π –º–µ—Ä–µ. –ù–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º —á–∞—Ç–µ.
- ‚ùå **UI:** –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –ø–µ—Ä–µ—Å–ª–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π.
- ‚ùå **–õ–æ–≥–∏–∫–∞:** –ù–µ—Ç –ª–æ–≥–∏–∫–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è *–∫–æ–ø–∏–∏* —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –Ω–æ–≤–æ–º —á–∞—Ç–µ.
- ‚ùå **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ø–µ—Ä–µ—Å—ã–ª–∫–∞:** –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞.

**–ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π:**
1.  **Backend:**
    *   **–ó–ê–î–ê–ß–ê:** –í `Message` –¥–æ–±–∞–≤–∏—Ç—å `forward_metadata` (JSONField), –≥–¥–µ –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è `original_author_name`, `original_chat_name` –∏ —Ç.–¥. –≠—Ç–æ –≥–∏–±—á–µ, —á–µ–º –º–Ω–æ–≥–æ CharField.
    *   **–ó–ê–î–ê–ß–ê:** –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π `type` –¥–ª—è WebSocket: `forward_messages`. –û–Ω –±—É–¥–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å `message_ids` –∏ `target_room_name`.
    *   **–ó–ê–î–ê–ß–ê:** –í `ChatConsumer` –Ω–∞–ø–∏—Å–∞—Ç—å –º–µ—Ç–æ–¥ `handle_forward_messages`, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å *–Ω–æ–≤—ã–µ* —Å–æ–æ–±—â–µ–Ω–∏—è –≤ `target_room_name` —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º `forward_metadata`.
2.  **Frontend:**
    *   **–ó–ê–î–ê–ß–ê:** –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é –ø—É–Ω–∫—Ç "–ü–µ—Ä–µ—Å–ª–∞—Ç—å".
    *   **–ó–ê–î–ê–ß–ê:** –ü—Ä–∏ –∫–ª–∏–∫–µ "–ü–µ—Ä–µ—Å–ª–∞—Ç—å" –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ —Å–ø–∏—Å–∫–æ–º —á–∞—Ç–æ–≤ –¥–ª—è –≤—ã–±–æ—Ä–∞. (MVP: —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–¥–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è).
    *   **–ó–ê–î–ê–ß–ê:** –í `createMessageElement` –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –±–ª–æ–∫–∞ "–ü–µ—Ä–µ—Å–ª–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ" –µ—Å–ª–∏ –≤ –¥–∞–Ω–Ω—ã—Ö –µ—Å—Ç—å `forward_metadata`. –°—Ç–∏–ª–∏–∑–æ–≤–∞—Ç—å —Å–æ–≥–ª–∞—Å–Ω–æ `BESEDKA_UI_STANDARDS.md`.

### 3.3. –°–∏—Å—Ç–µ–º–∞ —Ä–µ–∞–∫—Ü–∏–π (Reactions)

**–≠—Ç–∞–ª–æ–Ω–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (Telegram):**
- **–ë—ã—Å—Ç—Ä—ã–µ —Ä–µ–∞–∫—Ü–∏–∏:** –ü—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏/–¥–æ–ª–≥–æ–º —Ç–∞–ø–µ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –Ω–µ–±–æ–ª—å—à–æ–µ –º–µ–Ω—é —Å 5-7 –æ—Å–Ω–æ–≤–Ω—ã–º–∏ —ç–º–æ–¥–∑–∏.
- **–ü–æ–ª–Ω–æ–µ –º–µ–Ω—é:** –ö–Ω–æ–ø–∫–∞ "–µ—â–µ" –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—É—é –ø–∞–Ω–µ–ª—å —ç–º–æ–¥–∑–∏.
- **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:** –ü–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –±–ª–æ–∫–∏ —Å –æ—Ç—Ä–µ–∞–≥–∏—Ä–æ–≤–∞–≤—à–∏–º–∏ —ç–º–æ–¥–∑–∏ –∏ —Å—á–µ—Ç—á–∏–∫–∞–º–∏. –ö–ª–∏–∫ –Ω–∞ —Ç–∞–∫–æ–π –±–ª–æ–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫—Ç–æ –∏–º–µ–Ω–Ω–æ –æ—Ç—Ä–µ–∞–≥–∏—Ä–æ–≤–∞–ª.
- **–õ–æ–≥–∏–∫–∞:** –û–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å - –æ–¥–Ω–∞ —Ä–µ–∞–∫—Ü–∏—è –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ. –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∫–ª–∏–∫ –Ω–∞ —Ç–æ—Ç –∂–µ —ç–º–æ–¥–∑–∏ —Å–Ω–∏–º–∞–µ—Ç —Ä–µ–∞–∫—Ü–∏—é, –∫–ª–∏–∫ –Ω–∞ –¥—Ä—É–≥–æ–π - –º–µ–Ω—è–µ—Ç –µ–µ.

**–ù–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (–ê—É–¥–∏—Ç):**
- ‚úÖ **Backend:** –ï—Å—Ç—å `Reaction` –º–æ–¥–µ–ª—å —Å `GenericForeignKey`, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–∏–≤—è–∑—ã–≤–∞—Ç—å —Ä–µ–∞–∫—Ü–∏–∏ –∫ —á–µ–º—É —É–≥–æ–¥–Ω–æ.
- üü® **UI:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Ç–æ–ª—å–∫–æ –¥–≤–µ –∏–∫–æ–Ω–∫–∏ (üëç, üëé) –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏. –ù–µ—Ç –ø–æ–ª–Ω–æ–≥–æ –º–µ–Ω—é.
- üü® **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:** –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∏–∫–æ–Ω–∫–∏ –∏ —Å—á–µ—Ç—á–∏–∫–∏, –Ω–æ –Ω–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å, *–∫—Ç–æ* –æ—Ç—Ä–µ–∞–≥–∏—Ä–æ–≤–∞–ª.
- ‚úÖ **–õ–æ–≥–∏–∫–∞:** –û–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å - –æ–¥–Ω–∞ —Ä–µ–∞–∫—Ü–∏—è, –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∫–ª–∏–∫ —Å–Ω–∏–º–∞–µ—Ç.

**–ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π:**
1.  **Frontend:**
    *   **–ó–ê–î–ê–ß–ê:** –ó–∞–º–µ–Ω–∏—Ç—å –¥–≤–µ –∏–∫–æ–Ω–∫–∏ (üëç, üëé) –Ω–∞ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–µ –º–∏–Ω–∏-–º–µ–Ω—é, –∫–∞–∫ –≤ Telegram.
    *   **–ó–ê–î–ê–ßA (Backlog):** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω–æ–µ –º–µ–Ω—é —ç–º–æ–¥–∑–∏.
    *   **–ó–ê–î–ê–ß–ê:** –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ —Å—á–µ—Ç—á–∏–∫ —Ä–µ–∞–∫—Ü–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ —Å–ø–∏—Å–∫–æ–º –æ—Ç—Ä–µ–∞–≥–∏—Ä–æ–≤–∞–≤—à–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
2.  **Backend:**
    *   **–ó–ê–î–ê–ß–ê:** –°–æ–∑–¥–∞—Ç—å API —ç–Ω–¥–ø–æ–∏–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ `message_id` –∏ `reaction_emoji` –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

---
## 4. –ú–µ–¥–∏–∞ –∏ —Ñ–∞–π–ª—ã

### 4.1. –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ (Attachments)

**–≠—Ç–∞–ª–æ–Ω–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (Telegram):**
- **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –≤–∏–¥–µ–æ, –∞—É–¥–∏–æ –∏ –ª—é–±—ã–µ –¥—Ä—É–≥–∏–µ —Ñ–∞–π–ª—ã.
- **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å:**
    - –ö–Ω–æ–ø–∫–∞-—Å–∫—Ä–µ–ø–∫–∞ (üìé) –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –º–µ–Ω—é –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ –≤–ª–æ–∂–µ–Ω–∏—è (–§–æ—Ç–æ/–í–∏–¥–µ–æ, –§–∞–π–ª, ...).
    - Drag-and-drop —Ñ–∞–π–ª–æ–≤ –Ω–∞–ø—Ä—è–º—É—é –≤ –æ–∫–Ω–æ —á–∞—Ç–∞.
- **–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä (Preview):** –ü–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤ (–∫–∞—Ä—Ç–∏–Ω–æ–∫, –≤–∏–¥–µ–æ) –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–æ–º, –≥–¥–µ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–ø–∏—Å—å.
- **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ —á–∞—Ç–µ:**
    - **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è/–í–∏–¥–µ–æ:** –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –≤–∏–¥–µ –ø—Ä–µ–≤—å—é –ø—Ä—è–º–æ –≤ —á–∞—Ç–µ, –∫–ª–∏–∫ –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä—â–∏–∫.
    - **–§–∞–π–ª—ã:** –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –≤–∏–¥–µ –±–ª–æ–∫–∞ —Å –∏–∫–æ–Ω–∫–æ–π —Ñ–∞–π–ª–∞, –µ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏–µ–º, —Ä–∞–∑–º–µ—Ä–æ–º –∏ –∫–Ω–æ–ø–∫–æ–π –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è.

**–ù–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (–ê—É–¥–∏—Ç):**
- üü® **Backend:** –í –º–æ–¥–µ–ª–∏ `Message` –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ `image = models.ImageField`. –≠—Ç–æ–≥–æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ. –ù–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –¥—Ä—É–≥–∏—Ö —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤.
- ‚ùå **UI:** –ù–µ—Ç –∫–Ω–æ–ø–∫–∏-—Å–∫—Ä–µ–ø–∫–∏, –Ω–µ—Ç drag-and-drop.
- ‚ùå **–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä:** –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω.
- ‚ùå **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:** –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–∞—Ä—Ç–∏–Ω–∫–∏. –ë–ª–æ–∫–∞ –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–æ–≤ –Ω–µ—Ç.

**–ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π:**
1.  **Backend (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –±–ª–æ–∫):**
    *   **–ó–ê–î–ê–ß–ê:** –í –º–æ–¥–µ–ª–∏ `Message` –∑–∞–º–µ–Ω–∏—Ç—å `image` –Ω–∞ `file = models.FileField(upload_to='chat_files/')` –∏ –¥–æ–±–∞–≤–∏—Ç—å `media_type` (CharField) –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞ (`image`, `video`, `audio`, `document`).
    *   **–ó–ê–î–ê–ß–ê:** –°–æ–∑–¥–∞—Ç—å API —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤. –û–Ω –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ñ–∞–π–ª, –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –µ–≥–æ —Ç–∏–ø, —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å `file_url` –∏ `media_type`.
    *   **–ó–ê–î–ê–ß–ê:** –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å —Ñ–∞–π–ª–æ–º, WebSocket –¥–æ–ª–∂–µ–Ω –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω–æ–º —Ñ–∞–π–ª–µ.
2.  **Frontend:**
    *   **–ó–ê–î–ê–ß–ê:** –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É-—Å–∫—Ä–µ–ø–∫—É (üìé) —Ä—è–¥–æ–º —Å –ø–æ–ª–µ–º –≤–≤–æ–¥–∞.
    *   **–ó–ê–î–ê–ß–ê:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É –æ—Ç–∫—Ä—ã—Ç–∏—è —Ñ–∞–π–ª–æ–≤–æ–≥–æ –¥–∏–∞–ª–æ–≥–∞ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –Ω–∞ –Ω–æ–≤—ã–π API —ç–Ω–¥–ø–æ–∏–Ω—Ç.
    *   **–ó–ê–î–ê–ß–ê (MVP):** –ù–∞—á–∞—Ç—å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ç–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –Ω–æ —á–µ—Ä–µ–∑ –Ω–æ–≤—É—é —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É.
    *   **–ó–ê–î–ê–ß–ê:** –í `createMessageElement` –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –≤–ª–æ–∂–µ–Ω–∏–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç `media_type` (–ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É –µ—Å–ª–∏ `image`, –∏–ª–∏ –±–ª–æ–∫ —Ñ–∞–π–ª–∞ –µ—Å–ª–∏ `document`).
    *   **–ó–ê–î–ê–ß–ê (Backlog):** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å drag-and-drop.

### 4.2. –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å—Å—ã–ª–æ–∫ (Link Previews)

**–≠—Ç–∞–ª–æ–Ω–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (Telegram):**
- –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Å—Ç–∞–≤–ª—è–µ—Ç —Å—Å—ã–ª–∫—É –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞, Telegram –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ "–ø–∞—Ä—Å–∏—Ç" –µ–µ.
- –ß–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥ –ø–æ–¥ –ø–æ–ª–µ–º –≤–≤–æ–¥–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –±–ª–æ–∫ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º (–µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å –≤ Open Graph –º–µ—Ç–∞-—Ç–µ–≥–∞—Ö).
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π —Å–æ–æ–±—â–µ–Ω–∏—è.

**–ù–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (–ê—É–¥–∏—Ç):**
- ‚ùå **–ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ.**

**–ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π:**
1.  **Backend:**
    *   **–ó–ê–î–ê–ß–ê:** –°–æ–∑–¥–∞—Ç—å API —ç–Ω–¥–ø–æ–∏–Ω—Ç (`/api/chat/parse-link/`), –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç URL.
    *   **–ó–ê–î–ê–ß–ê:** –ù–∞ –±—ç–∫–µ–Ω–¥–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É —Ç–∏–ø–∞ `beautifulsoup4` –∏ `requests` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ URL –∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è Open Graph —Ç–µ–≥–æ–≤ (`og:title`, `og:description`, `og:image`).
    *   **–ó–ê–î–ê–ß–ê:** –≠–Ω–¥–ø–æ–∏–Ω—Ç –¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å JSON —Å —ç—Ç–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏.
2.  **Frontend:**
    *   **–ó–ê–î–ê–ß–ê:** –ù–∞–ø–∏—Å–∞—Ç—å JS-–ª–æ–≥–∏–∫—É, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –≤–≤–æ–¥ –≤ `textarea`. –ï—Å–ª–∏ –≤—Å—Ç–∞–≤–ª–µ–Ω —Ç–µ–∫—Å—Ç, –ø–æ—Ö–æ–∂–∏–π –Ω–∞ URL, —Å –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π (debounce) –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç `/api/chat/parse-link/`.
    *   **–ó–ê–î–ê–ß–ê:** –ï—Å–ª–∏ API –≤–µ—Ä–Ω—É–ª —É—Å–ø–µ—à–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –±–ª–æ–∫ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø–æ–¥ –ø–æ–ª–µ–º –≤–≤–æ–¥–∞ —Å –∫–Ω–æ–ø–∫–æ–π "x" –¥–ª—è –µ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è.
    *   **–ó–ê–î–ê–ß–ê:** –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω–∞ –≤ –¥–∞–Ω–Ω—ã–µ –¥–ª—è WebSocket.

---
## 5. –°–∏—Å—Ç–µ–º–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏

–≠—Ç–æ —Å–∞–º—ã–π —Å–ª–æ–∂–Ω—ã–π –∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π —Ä–∞–∑–¥–µ–ª, –∫–æ—Ç–æ—Ä—ã–π –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞–ª –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –ø—Ä–æ–±–ª–µ–º. –¶–µ–ª—å ‚Äî —Å—Ç—Ä–æ–≥–æ —Å–ª–µ–¥–æ–≤–∞—Ç—å —ç—Ç–∞–ª–æ–Ω–Ω–æ–º—É –ø–æ–≤–µ–¥–µ–Ω–∏—é Telegram, —á—Ç–æ–±—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–π –∏ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–π UX.

### 5.1. –°—Ç–∞—Ç—É—Å—ã —Å–æ–æ–±—â–µ–Ω–∏–π (Message Status)

**–≠—Ç–∞–ª–æ–Ω–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (Telegram):**
- **–û–¥–Ω–∞ —Å–µ—Ä–∞—è –≥–∞–ª–æ—á–∫–∞ (‚úì):** –°–æ–æ–±—â–µ–Ω–∏–µ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä.
- **–î–≤–µ —Å–µ—Ä—ã–µ –≥–∞–ª–æ—á–∫–∏ (‚úì‚úì):** –°–æ–æ–±—â–µ–Ω–∏–µ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ –ø–æ–ª—É—á–∞—Ç–µ–ª—é (—Ç.–µ. –∑–∞–≥—Ä—É–∂–µ–Ω–æ –≤ –µ–≥–æ –∫–ª–∏–µ–Ω—Ç).
- **–î–≤–µ –∑–µ–ª–µ–Ω—ã–µ/—Å–∏–Ω–∏–µ –≥–∞–ª–æ—á–∫–∏ (‚úì‚úì):** –ü–æ–ª—É—á–∞—Ç–µ–ª—å *–ø—Ä–æ—á–∏—Ç–∞–ª* —Å–æ–æ–±—â–µ–Ω–∏–µ. –í –≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–∞—Ö —ç—Ç–æ—Ç —Å—Ç–∞—Ç—É—Å –ø–æ—è–≤–ª—è–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –µ–≥–æ –ø—Ä–æ—á–∏—Ç–∞–ª —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —É—á–∞—Å—Ç–Ω–∏–∫ (–≤ –ª–∏—á–Ω—ã—Ö ‚Äî –∫–æ–≥–¥–∞ –ø—Ä–æ—á–∏—Ç–∞–ª —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫).

**–ù–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (–ê—É–¥–∏—Ç):**
- üü® **Backend:** –ï—Å—Ç—å `is_read` (BooleanField) –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–æ–æ–±—â–µ–Ω–∏—è. –≠—Ç–æ–≥–æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç—Ä–µ—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π.
- ‚ùå **UI:** –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤—Ä–µ–º—è. –ù–∏–∫–∞–∫–∏—Ö –≥–∞–ª–æ—á–µ–∫ –Ω–µ—Ç.
- ‚ùå **–õ–æ–≥–∏–∫–∞:** –ù–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –¥–æ—Å—Ç–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç—É.

**–ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π:**
1.  **Backend:**
    *   **–ó–ê–î–ê–ß–ê:** –í–º–µ—Å—Ç–æ `is_read` —Å–æ–∑–¥–∞—Ç—å –º–æ–¥–µ–ª—å `MessageReadStatus` —Å `user`, `message` –∏ `status` (`delivered`, `read`). –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å—Ç–∞—Ç—É—Å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞ —á–∞—Ç–∞.
    *   **–ó–ê–î–ê–ß–ê:** –ü—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ WebSocket, –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–±—ã—Ç–∏–µ –Ω–∞ –±—ç–∫—ç–Ω–¥ –æ —Ç–æ–º, —á—Ç–æ –≤—Å–µ –≤–∏–¥–∏–º—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è `delivered`.
    *   **–ó–ê–î–ê–ß–ê:** –ü—Ä–∏ –ø—Ä–æ—á—Ç–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏—è (–ª–æ–≥–∏–∫–∞ –∏–∑ –ø. 5.2), –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–±—ã—Ç–∏–µ –æ —Å—Ç–∞—Ç—É—Å–µ `read`.
    *   **–ó–ê–î–ê–ß–ê:** WebSocket –¥–æ–ª–∂–µ–Ω —Ä–∞—Å—Å—ã–ª–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ –¥—Ä—É–≥–∏–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º.
2.  **Frontend:**
    *   **–ó–ê–î–ê–ß–ê:** –í `createMessageElement` –¥–æ–±–∞–≤–∏—Ç—å –±–ª–æ–∫ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≥–∞–ª–æ—á–µ–∫.
    *   **–ó–ê–î–ê–ß–ê:** –ù–∞–ø–∏—Å–∞—Ç—å JS-–ª–æ–≥–∏–∫—É –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω—É–∂–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏ —Ü–≤–µ—Ç–∞ –≥–∞–ª–æ—á–µ–∫ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ç–∞—Ç—É—Å–∞, –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –æ—Ç WebSocket.

### 5.2. –°–∏—Å—Ç–µ–º–∞ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (Unread System)

**–≠—Ç–∞–ª–æ–Ω–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (Telegram):**
- **–†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å:** –ü—Ä–∏ –≤—Ö–æ–¥–µ –≤ —á–∞—Ç —Å –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏, –ø–æ—è–≤–ª—è–µ—Ç—Å—è —á–µ—Ç–∫–∏–π —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å "–ù–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è" –Ω–∞–¥ –ø–µ—Ä–≤—ã–º –∏–∑ –Ω–∏—Ö.
- **–ü–ª–∞–≤–∞—é—â–∞—è –∫–Ω–æ–ø–∫–∞:**
    - –ü–æ—è–≤–ª—è–µ—Ç—Å—è, –µ—Å–ª–∏ –µ—Å—Ç—å –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (`–∫–æ–Ω–≤–µ—Ä—Ç` + `—Å—á–µ—Ç—á–∏–∫`) –∏–ª–∏ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å–∫—Ä–æ–ª–ª–∏–ª –≤–≤–µ—Ä—Ö (`—Å—Ç—Ä–µ–ª–∫–∞ –≤–Ω–∏–∑` + `—Å—á–µ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–∏–∂–µ`).
    - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** `@—É–ø–æ–º–∏–Ω–∞–Ω–∏—è` (–∫—Ä–∞—Å–Ω–∞—è –∫–Ω–æ–ø–∫–∞) > `–Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ` (—Å–∏–Ω–∏–π –∫–æ–Ω–≤–µ—Ä—Ç) > `—Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∏–∂–µ` (—Å–µ—Ä–∞—è —Å—Ç—Ä–µ–ª–∫–∞).
- **–ê–≤—Ç–æ-–ø—Ä–æ—á—Ç–µ–Ω–∏–µ:** –°–æ–æ–±—â–µ–Ω–∏–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–º, –µ—Å–ª–∏ –æ–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –≤–∏–¥–∏–º–æ–π –æ–±–ª–∞—Å—Ç–∏ —ç–∫—Ä–∞–Ω–∞ ~3-5 —Å–µ–∫—É–Ω–¥, –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Å–∫—Ä–æ–ª–ª–∏—Ç.
- **–ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ü—Ä–∏ –≤—Ö–æ–¥–µ –≤ —á–∞—Ç —Å–∫—Ä–æ–ª–ª –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∫ –ø–µ—Ä–≤–æ–º—É –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç—Å—è –≤ –≤–µ—Ä—Ö–Ω–µ–π —Ç—Ä–µ—Ç–∏ —ç–∫—Ä–∞–Ω–∞.

**–ù–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (–ê—É–¥–∏—Ç):**
- üü® **–†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å:** –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω.
- üü® **–ü–ª–∞–≤–∞—é—â–∞—è –∫–Ω–æ–ø–∫–∞:** –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞, –Ω–æ —Å –±–∞–≥–∞–º–∏ –∏ —É–ø—Ä–æ—â–µ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–æ–π (—Ç–æ–ª—å–∫–æ —Å—Ç—Ä–µ–ª–∫–∞ –∏ `@`).
- ‚ùå **–ê–≤—Ç–æ-–ø—Ä–æ—á—Ç–µ–Ω–∏–µ:** –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ. –û—Ç–º–µ—Ç–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ –∏ –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ.
- ‚úÖ **–ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:** –°–∏—Å—Ç–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –ª–æ–≥–∏–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ –ø–µ—Ä–≤–æ–º—É –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–º—É —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏.

**–ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π:**
1.  **Frontend (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –±–ª–æ–∫):**
    *   **–ó–ê–î–ê–ß–ê:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É –≤—Å—Ç–∞–≤–∫–∏ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è "–ù–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è" –ø–µ—Ä–µ–¥ `first_unread_message_id`.
    *   **–ó–ê–î–ê–ß–ê:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –ª–æ–≥–∏–∫—É `updateFloatingUnreadBtn` –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –∏–µ—Ä–∞—Ä—Ö–∏–µ–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ Telegram. –î–æ–±–∞–≤–∏—Ç—å "–∫–æ–Ω–≤–µ—Ä—Ç".
    *   **–ó–ê–î–ê–ß–ê:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å "—É–º–Ω–æ–µ" –∞–≤—Ç–æ-–ø—Ä–æ—á—Ç–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é `Intersection Observer API` –∏ —Ç–∞–π–º–µ—Ä–æ–≤. –°–æ–æ–±—â–µ–Ω–∏—è, –ø–æ–ø–∞–¥–∞—é—â–∏–µ –≤ –≤–∏–¥–∏–º—É—é –æ–±–ª–∞—Å—Ç—å, –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å –Ω–∞ –ø—Ä–æ—á—Ç–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–∞—è –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –ø–æ—Å–ª–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–∫—Ä–æ–ª–ª–∞.
2.  **Backend:**
    *   **–ó–ê–î–ê–ß–ê:** `unread_info` –æ—Ç –±—ç–∫–µ–Ω–¥–∞ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å `first_unread_message_id`, `unread_count`, `personal_mention_count`. –≠—Ç–æ —É –Ω–∞—Å —É–∂–µ –µ—Å—Ç—å, –Ω—É–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö.

### 5.3. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–∞—Ö (Position Saving)

**–≠—Ç–∞–ª–æ–Ω–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (Telegram):**
- –ü—Ä–∏ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–∏ –≤ —á–∞—Ç, –≥–¥–µ –Ω–µ—Ç –Ω–æ–≤—ã—Ö –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –ø–æ–ø–∞–¥–∞—Ç—å —Ä–æ–≤–Ω–æ –≤ —Ç–æ –º–µ—Å—Ç–æ, –≥–¥–µ –æ–Ω –µ–≥–æ –ø–æ–∫–∏–Ω—É–ª.

**–ù–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (–ê—É–¥–∏—Ç):**
- üèÜ ‚úÖ **–ò–°–¢–û–†–ò–ß–ï–°–ö–ò–ô –£–°–ü–ï–•!** –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –±—ã–ª–∞ —É—Å–ø–µ—à–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞, –∫–∞–∫ —É–∫–∞–∑–∞–Ω–æ –≤ `PROGRESS.md`. –ú—ã –∑–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç (50 –¥–æ + 50 –ø–æ—Å–ª–µ) –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–æ–∑–∏—Ü–∏—é.

**–ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π:**
- **–ó–ê–î–ê–ß–ê (–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è):** **–ù–ï –°–õ–û–ú–ê–¢–¨!** –ü—Ä–∏ –ª—é–±—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –≤ –ª–æ–≥–∏–∫–µ —Å–∫—Ä–æ–ª–ª–∞ –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏, –ø—Ä–æ–≤–æ–¥–∏—Ç—å —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —ç—Ç–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è ‚Äî –Ω–∞—à "–∑–æ–ª–æ—Ç–æ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç", –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –Ω–µ—Ä—É—à–∏–º—ã–º.

---
## 6. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ: –û—Ç –ß–µ—Ä—Ç–µ–∂–∞ –∫ –î–æ—Ä–æ–∂–Ω–æ–π –ö–∞—Ä—Ç–µ

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø–æ–ª–Ω—É—é –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—é —Ü–µ–ª–µ–≤–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞. –ù–∞ –µ–≥–æ –æ—Å–Ω–æ–≤–µ –º—ã –º–æ–∂–µ–º —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—É—é, –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—É—é **–î–æ—Ä–æ–∂–Ω—É—é –ö–∞—Ä—Ç—É** –≤ `CUSTOM_CHAT_DEVELOPMENT_ROADMAP.md` —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏, –∏–∑–º–µ—Ä–∏–º—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏ –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏.

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å "–ü–ª–∞–Ω—ã –¥–µ–π—Å—Ç–≤–∏–π" –∏–∑ —ç—Ç–æ–≥–æ —á–µ—Ä—Ç–µ–∂–∞ –≤ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á –≤ `ROADMAP.md`.

---
## 7. UI/UX –∏ –í–∏–∑—É–∞–ª—å–Ω–∞—è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –ø–æ—Å–≤—è—â–µ–Ω –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏—é –∏ –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π Telegram –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —á–∏—Å—Ç–æ–≥–æ, –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –∏ —É–∑–Ω–∞–≤–∞–µ–º–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.

### 7.1. –¶–≤–µ—Ç–æ–≤–∞—è –ø–∞–ª–∏—Ç—Ä–∞ (Telegram Standard)

**–¶–µ–ª—å:** –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞—à–∏ "–ø–æ–¥–æ–±—Ä–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥–æ–º —Ç—ã–∫–∞" —Ü–≤–µ—Ç–∞ –Ω–∞ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é, –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—É—é –ø–∞–ª–∏—Ç—Ä—É Telegram –¥–ª—è —Å–≤–µ—Ç–ª–æ–π –∏ —Ç–µ–º–Ω–æ–π —Ç–µ–º. –≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç –æ—â—É—â–µ–Ω–∏–µ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –∏ –∫–æ–º—Ñ–æ—Ä—Ç–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π:**
1.  **–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å** –∏ –∏–∑–≤–ª–µ—á—å —Ç–æ—á–Ω—ã–µ —Ü–≤–µ—Ç–æ–≤—ã–µ –∫–æ–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Telegram Web.
2.  **–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å** –∏—Ö –∫–∞–∫ CSS-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ `static/css/chat_styles.css`.
3.  **–ó–∞–º–µ–Ω–∏—Ç—å** –≤—Å–µ –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ü–≤–µ—Ç–∞ –≤ —Å—Ç–∏–ª—è—Ö —á–∞—Ç–∞ –Ω–∞ —ç—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ.
4.  **–ü—Ä–æ–≤–µ—Å—Ç–∏ –∞—É–¥–∏—Ç** –∏ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã (—Ç–µ–∫—Å—Ç, –ø–æ–¥–ª–æ–∂–∫–∏, –∫–Ω–æ–ø–∫–∏, –≥—Ä–∞–Ω–∏—Ü—ã) –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ü–≤–µ—Ç–∞ –∏–∑ –Ω–æ–≤–æ–π –ø–∞–ª–∏—Ç—Ä—ã.

**–¶–≤–µ—Ç–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–±—É–¥—É—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –ø–æ—Å–ª–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è):**

```css
/* –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ */
:root {
  --theme_bg_color: #FFFFFF; /* –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–æ–Ω —á–∞—Ç–∞ */
  --theme_text_color: #000000; /* –û—Å–Ω–æ–≤–Ω–æ–π —Ü–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ */
  --theme_message_out_bg_color: #EEFFDE; /* –§–æ–Ω –∏—Å—Ö–æ–¥—è—â–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è (—Å–≤–µ—Ç–ª–æ-–∑–µ–ª–µ–Ω—ã–π) */
  --theme_message_in_bg_color: #FFFFFF; /* –§–æ–Ω –≤—Ö–æ–¥—è—â–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è (–±–µ–ª—ã–π) */
  --theme_link_color: #0088CC; /* –¶–≤–µ—Ç —Å—Å—ã–ª–æ–∫, —É–ø–æ–º–∏–Ω–∞–Ω–∏–π, –∞–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
  --theme_border_color: #E0E0E0; /* –¶–≤–µ—Ç –≥—Ä–∞–Ω–∏—Ü, —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–π */
  --theme_secondary_text_color: #8C8C8C; /* –í—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç (–≤—Ä–µ–º—è, —Å—Ç–∞—Ç—É—Å—ã) */
  --theme_header_bg_color: #FFFFFF; /* –§–æ–Ω —Ö–µ–¥–µ—Ä–∞ */
  --theme_input_bg_color: #F1F1F1; /* –§–æ–Ω –ø–æ–ª—è –≤–≤–æ–¥–∞ */
}

/* –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ */
[data-theme="dark"] {
  --theme_bg_color: #18222d; /* –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–æ–Ω —á–∞—Ç–∞ */
  --theme_text_color: #FFFFFF; /* –û—Å–Ω–æ–≤–Ω–æ–π —Ü–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ */
  --theme_message_out_bg_color: #2b5278; /* –§–æ–Ω –∏—Å—Ö–æ–¥—è—â–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è (–≥–ª—É–±–æ–∫–∏–π —Å–∏–Ω–∏–π) */
  --theme_message_in_bg_color: #1f2b38; /* –§–æ–Ω –≤—Ö–æ–¥—è—â–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è (—Ç–µ–º–Ω–æ-—Å–∏–Ω–∏–π) */
  --theme_link_color: #5294d5; /* –¶–≤–µ—Ç —Å—Å—ã–ª–æ–∫, —É–ø–æ–º–∏–Ω–∞–Ω–∏–π, –∞–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
  --theme_border_color: #25303e; /* –¶–≤–µ—Ç –≥—Ä–∞–Ω–∏—Ü, —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–π */
  --theme_secondary_text_color: #a1b0c3; /* –í—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç (–≤—Ä–µ–º—è, —Å—Ç–∞—Ç—É—Å—ã) */
  --theme_header_bg_color: #1f2b38; /* –§–æ–Ω —Ö–µ–¥–µ—Ä–∞ */
  --theme_input_bg_color: #18222d; /* –§–æ–Ω –ø–æ–ª—è –≤–≤–æ–¥–∞ */
}
``` 

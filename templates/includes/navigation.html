{% load static i18n %}
{% load core_tags %}
<nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top shadow-sm">
    <div class="container-fluid px-3 px-lg-4">
        <a class="navbar-brand fw-bold" href="{% url 'home' %}">
            <i class="fas fa-home"></i> –ë–µ—Å–µ–¥–∫–∞
        </a>

        <!-- –°–¢–ê–¢–£–° –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–Ø –û–¢–î–ï–õ–¨–ù–û –°–ü–†–ê–í–ê –û–¢ –õ–û–ì–û–¢–ò–ü–ê -->
        {% if request.resolver_match.url_name == 'room' or request.resolver_match.url_name == 'chat_test' %}
        <span id="connection-status" class="connection-status-nav status-connecting ms-2">
            <i class="fas fa-lock"></i>
        </span>
        {% endif %}

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavGlobal">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavGlobal">
            <!-- –õ–ï–í–ê–Ø –°–ï–ö–¶–ò–Ø: –û–°–ù–û–í–ù–´–ï –°–°–´–õ–ö–ò (—Å–∫—Ä—ã—Ç—ã –≤ —á–∞—Ç–µ) -->
            {% if request.resolver_match.url_name != 'room' and request.resolver_match.url_name != 'chat_test' %}
            <ul class="navbar-nav me-auto">
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'news:home' %}">
                        <i class="fas fa-newspaper"></i> –ù–æ–≤–æ—Å—Ç–∏
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'store:catalog' %}">
                        <i class="fas fa-store"></i> {% trans "–ú–∞–≥–∞–∑–∏–Ω" %}
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'growlogs:list' %}">
                        <i class="fas fa-seedling"></i> –ì—Ä–æ—É—Ä–µ–ø–æ—Ä—Ç—ã
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'gallery:gallery' %}">
                        <i class="fas fa-images"></i> –ì–∞–ª–µ—Ä–µ—è
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'chat:room' 'general' %}">
                        <i class="fas fa-comments"></i> {% trans "–ß–∞—Ç" %}
                    </a>
                </li>
            </ul>
            {% endif %}

            <!-- –¶–ï–ù–¢–†–ê–õ–¨–ù–ê–Ø –°–ï–ö–¶–ò–Ø: –ù–ê–ó–í–ê–ù–ò–ï –ß–ê–¢–ê (—Ç–æ–ª—å–∫–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö —á–∞—Ç–∞) -->
            {% if request.resolver_match.url_name == 'room' or request.resolver_match.url_name == 'chat_test' %}
            <div class="d-flex justify-content-center flex-grow-1">
                <ul class="navbar-nav">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle current-channel-nav
                           {% if request.resolver_match.kwargs.room_name == 'vip' %}channel-vip{% else %}channel-general{% endif %}"
                           href="#" id="channelDropdownNav" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="fas fa-{% if request.resolver_match.kwargs.room_name == 'vip' %}crown{% else %}comments{% endif %} me-1"></i>
                            <span id="currentChannelName">
                                {% if request.resolver_match.kwargs.room_name == 'general' %}
                                    –ë–µ—Å–µ–¥–∫–∞
                                {% elif request.resolver_match.kwargs.room_name == 'vip' %}
                                    –ë–µ—Å–µ–¥–∫–∞ - VIP
                                {% else %}
                                    –ß–∞—Ç
                                {% endif %}
                            </span>
                        </a>
                        <ul class="dropdown-menu shadow" aria-labelledby="channelDropdownNav">
                            <li><a class="dropdown-item channel-option-general" href="{% url 'chat:room' 'general' %}">
                                <span class="text-success">‚¨§</span> –ë–µ—Å–µ–¥–∫–∞
                            </a></li>
                            {% load chat_extras %}
                            {% can_access_vip_chat request.user as vip_access %}
                            {% if vip_access %}
                            <li><a class="dropdown-item channel-option-vip" href="{% url 'chat:room' 'vip' %}">
                                <span class="text-warning">‚¨§</span> –ë–µ—Å–µ–¥–∫–∞ - VIP
                            </a></li>
                            {% endif %}
                        </ul>
                    </li>
                </ul>
            </div>
            {% endif %}
            <ul class="navbar-nav ms-auto align-items-center">
                <!-- –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã - –∫–∞–∫ –∑–Ω–∞—á–æ–∫ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è -->
                <li class="nav-item">
                    <button class="nav-link btn border-0 bg-transparent theme-toggle-btn"
                            onclick="toggleTheme()"
                            title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É"
                            style="
                                /* üé® –î–ò–ó–ê–ô–ù –ö–ê–ö –£ –ó–ù–ê–ß–ö–ê –°–¢–ê–¢–£–°–ê –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–Ø (–£–í–ï–õ–ò–ß–ï–ù–û –î–û 36x36px) */
                                width: 36px;
                                height: 36px;
                                border-radius: 50%;
                                display: inline-flex;
                                align-items: center;
                                justify-content: center;
                                margin: 0;
                                padding: 0;

                                /* –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Ñ–æ–Ω –∫–∞–∫ —É —Å—Ç–∞—Ç—É—Å–∞ */
                                background: linear-gradient(135deg, #495057 0%, #343a40 50%, #212529 100%);
                                border: 2px solid #495057 !important;

                                /* –û–±—ä–µ–º–Ω—ã–µ —Ç–µ–Ω–∏ –≤ —Å—Ç–∏–ª–µ –∑–Ω–∞—á–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ */
                                box-shadow:
                                    0 6px 20px rgba(73, 80, 87, 0.4),
                                    0 3px 10px rgba(73, 80, 87, 0.3),
                                    0 2px 4px rgba(0, 0, 0, 0.2),
                                    inset 0 2px 0 rgba(255, 255, 255, 0.2),
                                    inset 0 -1px 0 rgba(0, 0, 0, 0.2);

                                backdrop-filter: blur(10px);
                                transition: all 0.3s ease;
                            ">
                        <i class="fas fa-moon theme-icon" style="color: #ffc107 !important; font-size: 16px; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);"></i>
                    </button>
                </li>
                <li class="nav-item d-flex align-items-center">
                    <a class="nav-link nav-link-with-counter d-flex align-items-center" href="{% url 'store:cart_detail' %}">
                        <i class="fas fa-shopping-cart nav-icon"></i>
                        <span class="nav-counter-badge cart-badge rounded-pill" style="{% if cart_items_count == 0 %}display: none;{% else %}display: flex;{% endif %}">
                            {{ cart_items_count|default:0 }}
                            <span class="visually-hidden">—Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω–µ</span>
                        </span>
                    </a>
                </li>
                <li class="nav-item d-flex align-items-center">
                    {% user_info_badge %}
                </li>
            </ul>
        </div>
    </div>
</nav>

<!-- üé® –°–¢–ò–õ–ò –î–õ–Ø –û–ë–™–ï–ú–ù–û–ô –ö–ù–û–ü–ö–ò –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–Ø –¢–ï–ú -->
<style>
/* Hover-—ç—Ñ—Ñ–µ–∫—Ç—ã –¥–ª—è –∫–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º –∫–∞–∫ —É –∑–Ω–∞—á–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ */
.theme-toggle-btn:hover {
    /* –£—Å–∏–ª–µ–Ω–Ω—ã–µ —Ç–µ–Ω–∏ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
    box-shadow:
        0 8px 25px rgba(73, 80, 87, 0.5) !important,
        0 4px 12px rgba(73, 80, 87, 0.4) !important,
        0 2px 6px rgba(0, 0, 0, 0.3) !important,
        inset 0 2px 0 rgba(255, 255, 255, 0.3) !important,
        inset 0 -1px 0 rgba(0, 0, 0, 0.3) !important;

    /* –õ–µ–≥–∫–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ */
    transform: scale(1.05);
}

/* –≠—Ñ—Ñ–µ–∫—Ç –Ω–∞–∂–∞—Ç–∏—è */
.theme-toggle-btn:active {
    transform: scale(0.95);
    box-shadow:
        0 4px 15px rgba(73, 80, 87, 0.4) !important,
        0 2px 8px rgba(73, 80, 87, 0.3) !important,
        0 1px 3px rgba(0, 0, 0, 0.2) !important,
        inset 0 1px 0 rgba(255, 255, 255, 0.2) !important;
}

/* SSOT –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø—Ä–∞–≤–æ–π —Å–µ–∫—Ü–∏–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ */
.navbar-nav.ms-auto {
    gap: 0; /* –£–±–∏—Ä–∞–µ–º –æ–±—â–∏–π gap, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –æ—Ç—Å—Ç—É–ø—ã */
}

/* –û—Ç–æ–¥–≤–∏–≥–∞–µ–º –∫–Ω–æ–ø–∫—É –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º –æ—Ç –∫–æ—Ä–∑–∏–Ω—ã */
.theme-toggle-btn {
    margin-right: 2.5rem !important; /* –ó–ê–ú–ï–¢–ù–û –£–í–ï–õ–ò–ß–ï–ù–ù–´–ô –æ—Ç—Å—Ç—É–ø —Å–ø—Ä–∞–≤–∞ –æ—Ç –∫–Ω–æ–ø–∫–∏ —Ç–µ–º */
}

/* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ—Ç–æ–¥–≤–∏–≥–∞–µ–º –≤–µ—Å—å li —ç–ª–µ–º–µ–Ω—Ç –∫–Ω–æ–ø–∫–∏ —Ç–µ–º */
.navbar-nav.ms-auto li.nav-item:first-child {
    margin-right: 1rem !important; /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –æ—Ç—Å—Ç—É–ø –¥–ª—è li —ç–ª–µ–º–µ–Ω—Ç–∞ */
}

/* –ö–æ–º–ø–∞–∫—Ç–Ω–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω—ã –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π */
.nav-link-with-counter {
    margin-right: 0.3rem !important; /* –ú–∞–ª–µ–Ω—å–∫–∏–π –æ—Ç—Å—Ç—É–ø —Å–ø—Ä–∞–≤–∞ –æ—Ç –∫–æ—Ä–∑–∏–Ω—ã */
}

.navbar-nav.ms-auto li.nav-item {
    display: flex;
    align-items: center;
    height: 60px; /* –í—ã—Å–æ—Ç–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ */
    margin: 0; /* –£–±–∏—Ä–∞–µ–º –≤—Å–µ margin - –∏—Å–ø–æ–ª—å–∑—É–µ–º gap –¥–ª—è —Ä–æ–¥–∏—Ç–µ–ª—è */
}

.nav-link-with-counter {
    height: auto !important;
    min-height: auto !important;
}

/* –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ inline –æ—Ç—Å—Ç—É–ø—ã –¥–ª—è –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ */
.navbar-nav.ms-auto .nav-item .nav-link {
    margin: 0 !important;
}
</style>

{# {% include 'includes/chat_modal.html' %} #}
